# Simplified NeRF Implementation

This is a simplified implementation of NeRF, without hierarchical sampling. The code is equipped with a tensorboard setup, and scripts to train a NeRF model and generate a set of novel views with the camera rotating on a spherical dome. 









https://user-images.githubusercontent.com/114626135/197914242-6efba591-2452-41ac-86bb-bd145aab65c2.mov


The video was generated by a model trained on 25 images, for 10000 iterations (takes around 30 min). 


[//]: <> (This drive [link](https://drive.google.com/drive/folders/1upzp3VQQSBWM8U182LmzmxcpjQ-Ou4wb?usp=share_link) has all the other NeRF videos for the CSE 274 project, including the phase optic experiment videos.)

## Setup 

```
git clone https://github.com/UCSD-Comp-Imaging/NeRF_CT
cd NeRF_CT 
pip install -r requirements.txt
```

Install training data for lego scene . Refer to [NeRF](https://www.matthewtancik.com/nerf) for other datasets. 
```



bash download_data.sh
```

## Training 
Modify the yaml file (for ex. lego.yaml) in `configs/` folder. The default lego yaml file fields are self explanatory. 

```
python3 train.py --config configs/lego.yaml
```
To start the tensorboard, open another terminal and run 
```
tensorboard --logdir=logs/
```
## Testing 
To render novel views, in the test section of the yaml file, set `animation=True` to render the video as shown in the example. 
```
python3 test.py --config configs/lego.yaml
```
## Roadmap 
- [ ] Hierarchical Sampling 
- [ ] Support for LLF data
- [ ] Integrate ColMap for training on real datasets 
- [ ] Versioning the packages in requirements





## Phase Optic results 


On training the NeRF model on 3 viewpoints, without any phase optic used for generating images.  



https://user-images.githubusercontent.com/114626135/205840333-8494dede-79d4-4bdf-969b-694397402b50.mov



On training the NeRF model on 3 viewpoints, with 100 lenslet uniform phase optic used for generating images.  



https://user-images.githubusercontent.com/114626135/205841079-5671d22a-c736-429f-bf5f-ddf834d6fac1.mov



On training the NeRF model on 3 viewpoints, with 100 lenslet uniform phase optic used for generating images.  




https://user-images.githubusercontent.com/114626135/205841623-469e6653-ebda-4d02-89be-fa82adefd24a.mov


